---
title: "QA/QC"
author: "Colin Wu"
date: "3/10/2021"
output: 
  html_document:
    toc: yes
    toc_float: yes
    code_folding: hide
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(ggplot2)
```

# Inventory
```{r inventory}
inventory <- read_csv("../Data/inventory/inventory.csv")

#add column to indicate if a specific tree had significant growth fron 2019 to 2020
inventory <- inventory %>%
  mutate(Sig_growth_2020 = abs(DBH_2020-DBH_2019) > 0.5)

print(inventory %>% select(DBH_2019,DBH_2020, Sig_growth_2020))
summary(inventory)
```

# Summary Table
```{r summary_table}
#create summary table that displays the number of trees of each species in each plot
summary_table <- inventory %>% 
  group_by(Plot, Species_code) %>% 
  summarize(num_trees = n())

print(summary_table, n=100)
```
# Long Example
```{r}
dat <- data.frame(Tag = 1:2, DBH_2019 = 2:3, DBH_2020 = 3:4)
print(dat)
dat %>% 
  pivot_longer(starts_with("DBH"), values_to = "DBH") %>% 
  separate(name, into = c("junk", "year")) %>% 
  select(-junk) ->
  dbh_data
print(dbh_data)
```


# Long Table
```{r long data}
#used method for pivoting long multiple columns from https://stackoverflow.com/questions/61367186/pivot-longer-into-multiple-columns

#Take all variables that end in a year and turn it into a categorical variable Type
long_inventory <- inventory %>%
  pivot_longer(grep(colnames(inventory), pattern=".*_\\d{4}"), names_pattern = "(.*)_(\\d{4})", names_to = c("Type","Year"), values_to = "val",  values_transform = list(val = as.character)) %>%
  relocate(c(Tag, Type, Year, val))

#Unpack Type into seperate variables
long_inventory <- long_inventory %>% 
  pivot_wider(names_from = Type, values_from=val) %>%
  relocate(c(Tag, Year, Date, Status, Sig_growth, DBH))

print(long_inventory, n = 300)
```

# Graphs
```{r graphs}
#Gizmolin246!
```

