---
title: "TEROS QA / QC"
author: "Stephanie Pennington"
date: "6/8/2021"
output: html_document
---

```{r setup, include=FALSE}
##this will use data from the "Current Data" folders

# In graphs, TRUE is "ok" while FALSE is "error"
TEST_COLOR_SCALE <- c("TRUE" = "black", "FALSE" = "red")

DAILY_TESTS <- list()

library(readr)
library(lubridate)
library(dplyr)
library(tidyr)
library(ggplot2)
theme_set(theme_minimal())

# Global chunk options
knitr:: opts_chunk$set(echo = FALSE)

# # Function setup
# read_sapflow <- function(filename) {
#   sdat <- readLines(filename)
#   sdat <- sdat[-3:-4] # remove lines 3 and 4 with unneeded information
#   
#   # parse line one to extract logger name
#   pnnl_x <- gregexpr("PNNL_", sdat[1])[[1]][1]
#   logger_name <- substr(sdat[1], start = pnnl_x, stop = pnnl_x + 6)
#   
#   read_csv(sdat, skip = 1) %>% 
#     mutate(Logger = logger_name)
# }

# From Anya's script:
# Helper function: read string vector into a data frame, reshape, and drop NA
fileread <- function(fn) {
    message("Reading ", basename(fn), "...")
    rawdata <- readLines(fn)[-c(1, 3, 4)]
    textConnection(rawdata) %>%
        read.csv(check.names = FALSE, na.strings = "NAN", stringsAsFactors = FALSE) %>%
        gather(channel, value, -TIMESTAMP, -RECORD, -Statname) %>%
        filter(!is.na(value))
}

```

``` {r process-data}
fileread("~/Dropbox/TEMPEST_PNNL_Data/Current_data/PNNL_11_Terosdata.dat") -> y
```

# Data Statistics
```{r, warning=FALSE}
library(skimr)
skim(y)
```

# Data visualization

## Daily cycle {.tabset}

### Control

### Fresh

### Salt

# Tests
